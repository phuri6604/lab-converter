<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Lab Converter</title>
<style>
body {
    font-family: Arial, sans-serif;
    max-width: 900px;
    margin: 20px auto;
}
textarea {
    width: 100%;
    height: 280px;
    font-family: monospace;
}
button {
    padding: 10px 18px;
    font-size: 16px;
    margin-top: 10px;
}
pre {
    background: #f5f5f5;
    padding: 12px;
    margin-top: 15px;
    white-space: pre-wrap;
}
</style>
</head>

<body>
<h2>Lab Text → One-line Summary</h2>

<textarea id="input" placeholder="Paste lab text here..."></textarea>

<button onclick="convert()">Convert</button>

<pre id="output"></pre>

<script>
const labMap = {
    "Hemoglobin": "Hb",
    "Hematocrit": "Hct",
    "WBC Count": "WBC",
    "Platelet Count": "Plt",

    "Blood Urea Nitrogen": "BUN",
    "Creatinine": "Cr",

    "Total Protein": "TP",
    "Albumin": "Alb",
    "Globulin": "Glb",
    "Direct Bilirubin": "DB",
    "Total Bilirubin": "TB",
    "Alkaline Phosphatase": "ALP",
    "SGPT2 (ALT)": "ALT",

    "Sodium": "Na",
    "Potassium": "K",
    "Chloride": "Cl",
    "TCO2": "TCO2",
    "Calcium": "Ca",
    "Phosphorus": "Phos",
    "Magnesium": "Mg",

    "Lactate": "Lactate"

    "PT": "PT",
    "APTT": "aPTT",
    "aPTT": "aPTT",
    "INR": "INR",
};

function convert() {
    const text = document.getElementById("input").value;
    const lines = text.split(/\r?\n/).map(l => l.trim()).filter(Boolean);
    const result = [];

    for (let i = 0; i < lines.length - 1; i++) {
        const name = lines[i].replace(/^-\s*/, "");

        if (labMap[name]) {
            const next = lines[i + 1];
            if (!next.includes("ไม่พบผล")) {
                const m = next.match(/([\d,.]+)/);
                if (m) {
                    result.push(`${labMap[name]} ${m[1].replace(/,/g, "")}`);
                }
            }
        }
    }

    document.getElementById("output").textContent =
        result.join(" ");
}
</script>

</body>
</html>
